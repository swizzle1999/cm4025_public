{"ast":null,"code":"import { getFromStorage, setInStorage } from \"./storage\"; //Component to check if the browser has a token stored we can use to log them in\n//This function returns a promise so we can wait for the database fetch request and then set state with the data we get from the fetch which will in turn update the user interface\n\nexport function checkForLocalToken() {\n  return new Promise(function (resolve, reject) {\n    //Get token from local storage\n    const token = getFromStorage(\"PokePacksOnline\"); //If the token exists\n\n    if (token) {\n      //Verify the token\n      let headers = {\n        \"x-auth-token\": token\n      };\n      fetch(\"api/auth/user\", {\n        method: \"GET\",\n        headers: headers\n      }).then(res => res.json()).then(json => {\n        //Check if the response contains a user, if it does, then it was a valid token\n        if (json._id) {\n          //Create a JSON object which contains the token, and then another nested JSON object which contains all of the users details needed to display\n          let returnObject = {\n            \"token\": token,\n            \"userObject\": json\n          };\n          resolve(returnObject);\n        }\n      });\n    } //If no token was found\n    else {\n        console.log(\"no token\");\n        resolve(null);\n      }\n  });\n}","map":{"version":3,"sources":["D:/Users/swizzle1999/Documents/Programming/MERN/cm4025/src/utils/checkForLocalToken.js"],"names":["getFromStorage","setInStorage","checkForLocalToken","Promise","resolve","reject","token","headers","fetch","method","then","res","json","_id","returnObject","console","log"],"mappings":"AAAA,SACIA,cADJ,EAEIC,YAFJ,QAGS,WAHT,C,CAKA;AAEA;;AACA,OAAO,SAASC,kBAAT,GAA6B;AAChC,SAAO,IAAIC,OAAJ,CAAa,UAASC,OAAT,EAAkBC,MAAlB,EAA0B;AAC9C;AACA,UAAMC,KAAK,GAAGN,cAAc,CAAC,iBAAD,CAA5B,CAF8C,CAG9C;;AACA,QAAIM,KAAJ,EAAW;AACT;AACA,UAAIC,OAAO,GAAG;AACZ,wBAAgBD;AADJ,OAAd;AAGAE,MAAAA,KAAK,CAAC,eAAD,EAAkB;AAACC,QAAAA,MAAM,EAAE,KAAT;AAAgBF,QAAAA,OAAO,EAAEA;AAAzB,OAAlB,CAAL,CACCG,IADD,CACMC,GAAG,IAAIA,GAAG,CAACC,IAAJ,EADb,EAECF,IAFD,CAEME,IAAI,IAAI;AACZ;AACA,YAAIA,IAAI,CAACC,GAAT,EAAa;AACX;AACA,cAAIC,YAAY,GAAG;AACjB,qBAASR,KADQ;AAEjB,0BAAcM;AAFG,WAAnB;AAIAR,UAAAA,OAAO,CAACU,YAAD,CAAP;AACD;AACF,OAZD;AAcD,KAnBD,CAoBA;AApBA,SAqBK;AACDC,QAAAA,OAAO,CAACC,GAAR,CAAY,UAAZ;AACAZ,QAAAA,OAAO,CAAC,IAAD,CAAP;AACH;AACA,GA7BM,CAAP;AA+BD","sourcesContent":["import {\r\n    getFromStorage,\r\n    setInStorage\r\n  } from \"./storage\"\r\n\r\n//Component to check if the browser has a token stored we can use to log them in\r\n\r\n//This function returns a promise so we can wait for the database fetch request and then set state with the data we get from the fetch which will in turn update the user interface\r\nexport function checkForLocalToken(){\r\n    return new Promise((function(resolve, reject) {\r\n    //Get token from local storage\r\n    const token = getFromStorage(\"PokePacksOnline\");\r\n    //If the token exists\r\n    if (token) {\r\n      //Verify the token\r\n      let headers = {\r\n        \"x-auth-token\": token\r\n      }\r\n      fetch(\"api/auth/user\", {method: \"GET\", headers: headers})\r\n      .then(res => res.json())\r\n      .then(json => {\r\n        //Check if the response contains a user, if it does, then it was a valid token\r\n        if (json._id){\r\n          //Create a JSON object which contains the token, and then another nested JSON object which contains all of the users details needed to display\r\n          let returnObject = {\r\n            \"token\": token,\r\n            \"userObject\": json\r\n          }\r\n          resolve(returnObject);\r\n        }\r\n      })\r\n\r\n    } \r\n    //If no token was found\r\n    else {\r\n        console.log(\"no token\");\r\n        resolve(null);\r\n    }\r\n    }));\r\n    \r\n  }\r\n"]},"metadata":{},"sourceType":"module"}