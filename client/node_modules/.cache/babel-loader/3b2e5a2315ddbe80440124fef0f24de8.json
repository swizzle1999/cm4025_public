{"ast":null,"code":"import _classCallCheck from\"D:\\\\Users\\\\swizzle1999\\\\Documents\\\\Programming\\\\MERN\\\\cm4025\\\\client\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";import _createClass from\"D:\\\\Users\\\\swizzle1999\\\\Documents\\\\Programming\\\\MERN\\\\cm4025\\\\client\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";import _possibleConstructorReturn from\"D:\\\\Users\\\\swizzle1999\\\\Documents\\\\Programming\\\\MERN\\\\cm4025\\\\client\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/possibleConstructorReturn\";import _getPrototypeOf from\"D:\\\\Users\\\\swizzle1999\\\\Documents\\\\Programming\\\\MERN\\\\cm4025\\\\client\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/getPrototypeOf\";import _inherits from\"D:\\\\Users\\\\swizzle1999\\\\Documents\\\\Programming\\\\MERN\\\\cm4025\\\\client\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";import _taggedTemplateLiteral from\"D:\\\\Users\\\\swizzle1999\\\\Documents\\\\Programming\\\\MERN\\\\cm4025\\\\client\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/taggedTemplateLiteral\";function _templateObject(){var data=_taggedTemplateLiteral([\"\\n.col-sm-4 {\\n    padding-left: 0 !important;\\n    height: 100vh;\\n}\\n\"]);_templateObject=function _templateObject(){return data;};return data;}import React from'react';import Accordion from\"react-bootstrap/Accordion\";import Col from\"react-bootstrap/Col\";import Form from'react-bootstrap/Form';import Row from\"react-bootstrap/Row\";import styled from\"styled-components\";import'./App.css';import AddPackComponent from\"./components/AddPackComponent\";import AdminComponent from\"./components/AdminComponent\";import InventoryListComponent from\"./components/InventoryListComponent\";import LoginComponent from'./components/LoginComponent';import NavbarLeftPanelComponent from'./components/NavbarLeftPanelComponent';import NavbarRightPanelComponent from'./components/NavbarRightPanelComponent';import PackListComponent from\"./components/PackListComponent\";import PlayerStatsComponent from'./components/PlayerStatsComponent';import RegisterComponent from'./components/RegisterComponent';import ShopComponent from\"./components/ShopComponent\";import AboutComponent from\"./components/AboutComponent\";import{setInStorage}from\"./utils/storage\";var checkForLocalToken=require(\"./utils/checkForLocalToken\");var sortPacksByLevel=require(\"./utils/sortPacksByLevel\");var fetch=require(\"node-fetch\");var Styles=styled.div(_templateObject());var App=/*#__PURE__*/function(_React$Component){_inherits(App,_React$Component);function App(props){var _this;_classCallCheck(this,App);_this=_possibleConstructorReturn(this,_getPrototypeOf(App).call(this,props));//Setting up the initial state\n_this.NavbarRightPanelComponentChildCallback=function(dataFromChild){if(dataFromChild.openPacks){_this.setState({rightPanelComponent:\"PackListComponent\"});}else if(dataFromChild.inventory){_this.setState({rightPanelComponent:\"InventoryListComponent\"});}else if(dataFromChild.addPack){_this.setState({rightPanelComponent:\"AddPackComponent\"});}else if(dataFromChild.admin){//Yes a client could modify this and get access to the admin panel\n//But all the API calls from the admin panel are protected serverside with tokens so it dosent actually matter if they can acess it. They get no important information nor can they actually send any requests from it\n//This is here just because it makes sense for a user not to be able to instantly click into an admin panel\nif(_this.state.admin==true){_this.setState({rightPanelComponent:\"AdminComponent\"});}}else if(dataFromChild.about){_this.setState({rightPanelComponent:\"AboutComponent\"});}};_this.NavbarLeftPanelComponentChildCallback=function(dataFromChild){if(dataFromChild.logOut){//Remove the users token from storage if they want to log out\nsetInStorage(\"PokePacksOnline\",\"\");_this.setState({token:\"\",userObject:{}});}else if(dataFromChild.playerStats){_this.setState({leftPanelComponent:\"PlayerStatsComponent\"});}else if(dataFromChild.shop){_this.setState({leftPanelComponent:\"ShopComponent\"});}};_this.leftPanelComponentChildCallback=function(dataFromChild){//if the child is telling the parent to load a new component\nif(dataFromChild.componentToLoad){_this.setState({leftPanelComponent:dataFromChild.componentToLoad});}//If the child wants to log a user in\nelse if(dataFromChild.login){//Sends a request to the auth api route with the users email and password\nfetch(\"/api/auth/\",{method:\"POST\",headers:{\"accepts\":\"application/json\",\"Content-Type\":\"application/json\"},body:JSON.stringify({\"email\":dataFromChild.email,\"password\":dataFromChild.password})}).then(function(res){return res.json();}).then(function(json){//If the API responds with a token then we set that token in storage\n//Yes someone could intercept this and place a fake token in, but it would do no good since they need to send a VALID token with authenticated requests\nif(json.token){_this.setState({leftPanelComponentInformationMessage:\"\"});setInStorage(\"PokePacksOnline\",json.token);_this.setState({leftPanelComponent:\"PlayerStatsComponent\"});//Get token from local storage and then fetch the users details from the database which is then set in state\ncheckForLocalToken.checkForLocalToken().then(function(returnObject){if(returnObject!=null){_this.setState({token:returnObject.token,admin:returnObject.userObject.admin,userObject:returnObject.userObject});}});}else{_this.setState({leftPanelComponentInformationMessage:\"Invalid Credentials, Please Try Again\"});console.log(\"Invalid credentials\");}});}//If the child wants to register a user\nelse if(dataFromChild.register){//Similar to login with a post request send to users with username and password\nfetch(\"/api/users/\",{method:\"POST\",headers:{\"accepts\":\"application/json\",\"Content-Type\":\"application/json\"},body:JSON.stringify({\"username\":dataFromChild.username,\"email\":dataFromChild.email,\"password\":dataFromChild.password,\"confirmPassword\":dataFromChild.confirmPassword})}).then(function(res){return res.json();}).then(function(json){if(json.token){_this.setState({leftPanelComponent:\"LoginComponent\"});}else{console.log(\"Invalid credentials\");}});}//If the child wants to delete a user\nelse if(dataFromChild.delete){//Simple delete API request that deletes an account based on its token\nfetch(\"/api/auth/user/delete\",{method:\"GET\",headers:{\"x-auth-token\":_this.state.token}}).then(function(res){setInStorage(\"PokePacksOnline\",\"\");_this.setState({token:\"\",userObject:{}});_this.setState({leftPanelComponent:\"LoginComponent\"});});}};_this.rightPanelComponentChildCallback=function(dataFromChild){//if the child is telling the parent to load a new component\nif(dataFromChild.openedPack){_this.setState({openedPackForceShopUpdate:_this.state.openedPackForceShopUpdate+1});}};_this.handleInputChange=function(event){_this.setState({packFilter:event.target.value});};_this.state={time:Date.now(),packs:[],token:\"\",admin:false,userObject:{},leftPanelComponent:\"PlayerStatsComponent\",leftPanelComponentInformationMessage:\"\",rightPanelComponent:\"PackListComponent\",packFilter:\"\",openedPackForceShopUpdate:0};return _this;}_createClass(App,[{key:\"componentDidMount\",value:function componentDidMount(){var _this2=this;//Quick check to see if the user has an existing token\ncheckForLocalToken.checkForLocalToken().then(function(returnObject){if(returnObject!=null){_this2.setState({token:returnObject.token,admin:returnObject.userObject.admin,userObject:returnObject.userObject});}});//Fetch all the packs that exist in the database to be displayed\nfetch(\"/api/packs\",{method:\"GET\",headers:{\"accepts\":\"application/json\"}}).then(function(res){return res.json();}).then(function(json){var packArray=_this2.state.packs;for(var i=0;i<json.packs.length;i++){packArray.push(json.packs[i]);}packArray.sort(sortPacksByLevel.compare);_this2.setState({packs:packArray});});}// -------------------- \"ToRender\" functions decide which component should be rendered on that side of the screen --------------------\n//Function that is used to change what renders on the left panel\n},{key:\"leftPanelComponentToRender\",value:function leftPanelComponentToRender(){//Switch statement to check which component should be rendered on the left\nswitch(this.state.leftPanelComponent){case\"LoginComponent\"://If a token does not exist the user is not logged in, so will just show the player stats component\nif(this.state.token){this.setState({leftPanelComponent:\"PlayerStatsComponent\"});}else{return React.createElement(LoginComponent,{informationMessage:this.state.leftPanelComponentInformationMessage,callbackToParent:this.leftPanelComponentChildCallback});}case\"RegisterComponent\":return React.createElement(RegisterComponent,{callbackToParent:this.leftPanelComponentChildCallback});case\"PlayerStatsComponent\":if(this.state.token){return React.createElement(PlayerStatsComponent,{token:this.state.token,callbackToParent:this.leftPanelComponentChildCallback});}else{this.setState({leftPanelComponent:\"LoginComponent\"});}case\"ShopComponent\":if(this.state.token){return React.createElement(ShopComponent,{token:this.state.token,shouldForceUpdate:this.state.openedPackForceShopUpdate,callbackToParent:this.leftPanelComponentChildCallback});}else{this.setState({leftPanelComponent:\"LoginComponent\"});}}}//Same as function above, just a switch statement to see what should be rendered on the right side of the screen\n},{key:\"rightPanelComponentToRender\",value:function rightPanelComponentToRender(){switch(this.state.rightPanelComponent){case\"PackListComponent\":return this.renderPacks(this.state.packs);case\"InventoryListComponent\":if(this.state.token){return this.renderUserPacks(this.state.packs);}else{this.setState({rightPanelComponent:\"PackListComponent\"});}case\"AddPackComponent\":return React.createElement(AddPackComponent,null);case\"AdminComponent\":return React.createElement(AdminComponent,null);case\"AboutComponent\":return React.createElement(AboutComponent,null);}}// ================================================================================\n// -------------------- \"CallBack\" are used by child components to send information back to their parent (this) --------------------\n//This is the function that the nav bar will call back to to inform the parent (this component) which component it should now render\n//This is how child components like the navbar communicate with their parent components\n},{key:\"renderPacks\",// ================================================================================\n//-------------------- renderPacks functions are used to map all of the packs to PackListComponents --------------------\n//Renders all the packs to the main screen\nvalue:function renderPacks(packs){var _this3=this;//This is a method that will appear a lot throughout this website\n//Essentially its a loop through an array and you can then assign each element in that array to its own component, passing it in properties like name and code etc.\n//This means each pack in this case gets its own component and then the website is able to display a list of these components\nreturn packs.map(function(pack){return React.createElement(PackListComponent,{key:pack.code,code:pack.code,name:pack.name,cards:pack.cards,cost:pack.cost,level:pack.level,totalCards:pack.totalCards,filter:_this3.state.packFilter,callbackToParent:_this3.rightPanelComponentChildCallback});});}//Renders all the packs the user owns\n},{key:\"renderUserPacks\",value:function renderUserPacks(packs){var _this4=this;return packs.map(function(pack){return React.createElement(InventoryListComponent,{key:pack.code,code:pack.code,name:pack.name,cards:pack.cards,totalCards:pack.totalCards,filter:_this4.state.packFilter});});}// ================================================================================\n//Handles the filter at the top of the screen.\n//Whenever something in the input box changes the state is updated with the new filter\n},{key:\"renderFilterBar\",//Simply rendering the filter bar\nvalue:function renderFilterBar(){if(this.state.rightPanelComponent==\"InventoryListComponent\"||this.state.rightPanelComponent==\"PackListComponent\"){return React.createElement(Form,null,React.createElement(Form.Group,{controlId:\"cardFilter\"},React.createElement(Form.Label,{style:{color:\"white\"}},\"Filter By Card Name\"),React.createElement(Form.Control,{type:\"string\",placeholder:\"\",onChange:this.handleInputChange})));}}//The main render method\n//This is what is actually displaying things to the screen\n},{key:\"render\",value:function render(){var packs=this.state.packs;return React.createElement(\"div\",{className:\"App\"},React.createElement(Styles,null,React.createElement(NavbarRightPanelComponent,{rightPanelComponent:this.state.rightPanelComponent,callbackToParent:this.NavbarRightPanelComponentChildCallback,admin:this.state.admin}),React.createElement(Row,{style:{margin:\"0 auto\"}},React.createElement(Col,null,React.createElement(NavbarLeftPanelComponent,{leftPanelComponent:this.state.leftPanelComponent,callbackToParent:this.NavbarLeftPanelComponentChildCallback}),this.leftPanelComponentToRender()),React.createElement(Col,{style:{marginTop:\"0.5rem\"},sm:8},React.createElement(Accordion,null,this.renderFilterBar(),this.rightPanelComponentToRender())))));}}]);return App;}(React.Component);export default App;","map":{"version":3,"sources":["D:/Users/swizzle1999/Documents/Programming/MERN/cm4025/client/src/App.js"],"names":["React","Accordion","Col","Form","Row","styled","AddPackComponent","AdminComponent","InventoryListComponent","LoginComponent","NavbarLeftPanelComponent","NavbarRightPanelComponent","PackListComponent","PlayerStatsComponent","RegisterComponent","ShopComponent","AboutComponent","setInStorage","checkForLocalToken","require","sortPacksByLevel","fetch","Styles","div","App","props","NavbarRightPanelComponentChildCallback","dataFromChild","openPacks","setState","rightPanelComponent","inventory","addPack","admin","state","about","NavbarLeftPanelComponentChildCallback","logOut","token","userObject","playerStats","leftPanelComponent","shop","leftPanelComponentChildCallback","componentToLoad","login","method","headers","body","JSON","stringify","email","password","then","res","json","leftPanelComponentInformationMessage","returnObject","console","log","register","username","confirmPassword","delete","rightPanelComponentChildCallback","openedPack","openedPackForceShopUpdate","handleInputChange","event","packFilter","target","value","time","Date","now","packs","packArray","i","length","push","sort","compare","renderPacks","renderUserPacks","map","pack","code","name","cards","cost","level","totalCards","color","margin","leftPanelComponentToRender","marginTop","renderFilterBar","rightPanelComponentToRender","Component"],"mappings":"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","sourcesContent":["import React from 'react';\nimport Accordion from \"react-bootstrap/Accordion\";\nimport Col from \"react-bootstrap/Col\";\nimport Form from 'react-bootstrap/Form';\nimport Row from \"react-bootstrap/Row\";\nimport styled from \"styled-components\";\nimport './App.css';\nimport AddPackComponent from \"./components/AddPackComponent\";\nimport AdminComponent from \"./components/AdminComponent\";\nimport InventoryListComponent from \"./components/InventoryListComponent\";\nimport LoginComponent from './components/LoginComponent';\nimport NavbarLeftPanelComponent from './components/NavbarLeftPanelComponent';\nimport NavbarRightPanelComponent from './components/NavbarRightPanelComponent';\nimport PackListComponent from \"./components/PackListComponent\";\nimport PlayerStatsComponent from './components/PlayerStatsComponent';\nimport RegisterComponent from './components/RegisterComponent';\nimport ShopComponent from \"./components/ShopComponent\";\nimport AboutComponent from \"./components/AboutComponent\";\nimport { setInStorage } from \"./utils/storage\";\n\n\nconst checkForLocalToken = require(\"./utils/checkForLocalToken\");\nconst sortPacksByLevel = require(\"./utils/sortPacksByLevel\");\n\nconst fetch = require(\"node-fetch\");\n\nconst Styles = styled.div`\n.col-sm-4 {\n    padding-left: 0 !important;\n    height: 100vh;\n}\n`\n\nclass App extends React.Component {\n  constructor(props){\n    super(props);\n\n    //Setting up the initial state\n    this.state = {\n      time: Date.now(),\n      packs: [],\n      token: \"\",\n      admin: false,\n      userObject: {},\n      leftPanelComponent: \"PlayerStatsComponent\",\n      leftPanelComponentInformationMessage: \"\",\n      rightPanelComponent: \"PackListComponent\",\n      packFilter: \"\",\n      openedPackForceShopUpdate: 0\n    }\n  }\n\n\n  componentDidMount(){\n    //Quick check to see if the user has an existing token\n    checkForLocalToken.checkForLocalToken()\n    .then(returnObject => {\n      if (returnObject != null){\n        this.setState({\n          token: returnObject.token,\n          admin: returnObject.userObject.admin,\n          userObject: returnObject.userObject,\n      })\n      }\n    })\n\n    //Fetch all the packs that exist in the database to be displayed\n    fetch(\"/api/packs\", {method: \"GET\", headers:{\"accepts\": \"application/json\"}})\n      .then(res => res.json())\n      .then(json => {\n        let packArray = this.state.packs\n        for (let i = 0; i < json.packs.length; i++){\n          packArray.push(json.packs[i]);\n        }\n        packArray.sort(sortPacksByLevel.compare)\n        this.setState({packs: packArray});\n      })\n\n      \n\n  }\n\n  // -------------------- \"ToRender\" functions decide which component should be rendered on that side of the screen --------------------\n  //Function that is used to change what renders on the left panel\n  leftPanelComponentToRender(){\n    //Switch statement to check which component should be rendered on the left\n    switch(this.state.leftPanelComponent){\n      case \"LoginComponent\":\n        //If a token does not exist the user is not logged in, so will just show the player stats component\n        if(this.state.token){\n          this.setState({\n            leftPanelComponent: \"PlayerStatsComponent\",\n          })\n        } else {\n          return <LoginComponent informationMessage={this.state.leftPanelComponentInformationMessage} callbackToParent={this.leftPanelComponentChildCallback}/>\n        }\n      case \"RegisterComponent\":\n        return <RegisterComponent callbackToParent={this.leftPanelComponentChildCallback}/>\n      case \"PlayerStatsComponent\":\n        if(this.state.token){\n          return <PlayerStatsComponent token={this.state.token} callbackToParent={this.leftPanelComponentChildCallback}/>  \n        } else {\n          this.setState({\n            leftPanelComponent: \"LoginComponent\",\n          })\n        }\n      case \"ShopComponent\":\n        if(this.state.token){\n          return <ShopComponent token={this.state.token} shouldForceUpdate={this.state.openedPackForceShopUpdate} callbackToParent={this.leftPanelComponentChildCallback}/> \n        } else {\n          this.setState({\n            leftPanelComponent: \"LoginComponent\",\n          })\n        }\n    }\n  }\n\n  //Same as function above, just a switch statement to see what should be rendered on the right side of the screen\n  rightPanelComponentToRender(){\n    switch(this.state.rightPanelComponent){\n      case \"PackListComponent\":\n        return this.renderPacks(this.state.packs)\n      case \"InventoryListComponent\":\n        if (this.state.token){\n          return this.renderUserPacks(this.state.packs);\n        } else {\n          this.setState({\n            rightPanelComponent: \"PackListComponent\",\n          })\n        }\n      case \"AddPackComponent\":\n        return <AddPackComponent />\n      case \"AdminComponent\":\n        return <AdminComponent />\n      case \"AboutComponent\":\n        return <AboutComponent />\n\n    }\n  }\n  // ================================================================================\n\n  // -------------------- \"CallBack\" are used by child components to send information back to their parent (this) --------------------\n  //This is the function that the nav bar will call back to to inform the parent (this component) which component it should now render\n  //This is how child components like the navbar communicate with their parent components\n  NavbarRightPanelComponentChildCallback = dataFromChild => {\n    if (dataFromChild.openPacks){\n      this.setState({\n        rightPanelComponent: \"PackListComponent\",\n      })\n    }else if (dataFromChild.inventory){\n      this.setState({\n        rightPanelComponent: \"InventoryListComponent\",\n      })\n    }else if (dataFromChild.addPack){\n      this.setState({\n        rightPanelComponent: \"AddPackComponent\",\n      })\n    }else if (dataFromChild.admin){\n      //Yes a client could modify this and get access to the admin panel\n      //But all the API calls from the admin panel are protected serverside with tokens so it dosent actually matter if they can acess it. They get no important information nor can they actually send any requests from it\n      //This is here just because it makes sense for a user not to be able to instantly click into an admin panel\n      if (this.state.admin == true) {\n        this.setState({\n          rightPanelComponent: \"AdminComponent\",\n        })\n      }\n    }else if (dataFromChild.about){\n      this.setState({\n        rightPanelComponent: \"AboutComponent\",\n      })\n    }\n  }\n\n  //Similar to the function above but instead for the left nav bar\n  NavbarLeftPanelComponentChildCallback = dataFromChild => {\n    if (dataFromChild.logOut){\n      //Remove the users token from storage if they want to log out\n      setInStorage(\"PokePacksOnline\", \"\");\n      this.setState({\n        token: \"\",\n        userObject: {},\n      })\n    } \n    else if (dataFromChild.playerStats){\n      this.setState({\n        leftPanelComponent: \"PlayerStatsComponent\",\n      })\n    }\n    else if (dataFromChild.shop){\n      this.setState({\n        leftPanelComponent: \"ShopComponent\",\n      })\n    }\n  }\n\n  //The callback all components that use the left panel use to communicate with the parent (this)\n  leftPanelComponentChildCallback = dataFromChild => {\n    //if the child is telling the parent to load a new component\n    if (dataFromChild.componentToLoad){\n      this.setState({\n        leftPanelComponent: dataFromChild.componentToLoad,\n      })\n    } \n    //If the child wants to log a user in\n    else if(dataFromChild.login) {\n      //Sends a request to the auth api route with the users email and password\n      fetch(\"/api/auth/\", {method: \"POST\", headers:{\"accepts\": \"application/json\", \"Content-Type\": \"application/json\"}, body: JSON.stringify({\"email\": dataFromChild.email, \"password\": dataFromChild.password})})\n      .then(res => res.json())\n      .then(json => {\n        //If the API responds with a token then we set that token in storage\n        //Yes someone could intercept this and place a fake token in, but it would do no good since they need to send a VALID token with authenticated requests\n        if (json.token){\n          this.setState({\n            leftPanelComponentInformationMessage: \"\"\n          })\n           setInStorage(\"PokePacksOnline\", json.token);\n           this.setState({\n            leftPanelComponent: \"PlayerStatsComponent\",\n            })\n          //Get token from local storage and then fetch the users details from the database which is then set in state\n          checkForLocalToken.checkForLocalToken()\n          .then(returnObject => {\n            if (returnObject != null){\n              this.setState({\n                token: returnObject.token,\n                admin: returnObject.userObject.admin,\n                userObject: returnObject.userObject,\n            })\n            }\n          })\n        } else {\n          this.setState({\n            leftPanelComponentInformationMessage: \"Invalid Credentials, Please Try Again\"\n          })\n          console.log(\"Invalid credentials\");\n        }\n      })\n    } \n    //If the child wants to register a user\n    else if (dataFromChild.register){\n      //Similar to login with a post request send to users with username and password\n      fetch(\"/api/users/\", {method: \"POST\", headers:{\"accepts\": \"application/json\", \"Content-Type\": \"application/json\"}, body: JSON.stringify({\"username\": dataFromChild.username, \"email\": dataFromChild.email, \"password\": dataFromChild.password, \"confirmPassword\": dataFromChild.confirmPassword})})\n      .then(res => res.json())\n      .then(json => {\n        if (json.token){\n           this.setState({\n             leftPanelComponent: \"LoginComponent\",\n           })\n        } else {\n          console.log(\"Invalid credentials\");\n        }\n      })\n    }\n    //If the child wants to delete a user\n    else if (dataFromChild.delete){\n      //Simple delete API request that deletes an account based on its token\n      fetch(\"/api/auth/user/delete\", {method: \"GET\", headers:{\"x-auth-token\": this.state.token}})\n      .then(res => {\n        setInStorage(\"PokePacksOnline\", \"\");\n        this.setState({\n          token: \"\",\n          userObject: {},\n        })\n        this.setState({\n          leftPanelComponent: \"LoginComponent\",\n        })\n      })\n    }\n  }\n\n  //The callback all components that use the left panel use to communicate with the parent (this)\n  rightPanelComponentChildCallback = dataFromChild => {\n    //if the child is telling the parent to load a new component\n    if (dataFromChild.openedPack){\n      this.setState({\n        openedPackForceShopUpdate: this.state.openedPackForceShopUpdate + 1\n      })\n    } \n  }\n  // ================================================================================\n\n  //-------------------- renderPacks functions are used to map all of the packs to PackListComponents --------------------\n  //Renders all the packs to the main screen\n  renderPacks(packs) {\n    //This is a method that will appear a lot throughout this website\n    //Essentially its a loop through an array and you can then assign each element in that array to its own component, passing it in properties like name and code etc.\n    //This means each pack in this case gets its own component and then the website is able to display a list of these components\n    return packs.map(pack => <PackListComponent key={pack.code} code={pack.code} name={pack.name} cards={pack.cards} cost={pack.cost} level={pack.level} totalCards={pack.totalCards} filter={this.state.packFilter} callbackToParent={this.rightPanelComponentChildCallback}/>)\n  }\n\n  //Renders all the packs the user owns\n  renderUserPacks(packs) {\n    return packs.map(pack => <InventoryListComponent key={pack.code} code={pack.code} name={pack.name} cards={pack.cards} totalCards={pack.totalCards} filter={this.state.packFilter}/>)\n  }\n  // ================================================================================\n\n  //Handles the filter at the top of the screen.\n  //Whenever something in the input box changes the state is updated with the new filter\n  handleInputChange = event => {\n    this.setState({packFilter: event.target.value})\n  }\n\n  //Simply rendering the filter bar\n  renderFilterBar(){\n    if (this.state.rightPanelComponent == \"InventoryListComponent\" || this.state.rightPanelComponent == \"PackListComponent\"){\n      return (\n        <Form>\n          <Form.Group controlId=\"cardFilter\">\n            <Form.Label style={{color: \"white\"}}>Filter By Card Name</Form.Label>\n            <Form.Control type=\"string\" placeholder=\"\" onChange={this.handleInputChange}/>\n          </Form.Group>\n        </Form>\n      );\n    }\n  }\n\n  //The main render method\n  //This is what is actually displaying things to the screen\n  render() {\n    const {packs} = this.state;\n    return (\n      <div className=\"App\">\n        <Styles>\n          <NavbarRightPanelComponent rightPanelComponent={this.state.rightPanelComponent} callbackToParent={this.NavbarRightPanelComponentChildCallback} admin={this.state.admin}/>\n          <Row style={{margin: \"0 auto\"}}>\n            <Col>\n              <NavbarLeftPanelComponent leftPanelComponent={this.state.leftPanelComponent} callbackToParent={this.NavbarLeftPanelComponentChildCallback}/>\n              {this.leftPanelComponentToRender()}\n            </Col>\n            <Col style={{marginTop: \"0.5rem\"}} sm={8}>\n              <Accordion>\n                {this.renderFilterBar()}\n                {this.rightPanelComponentToRender()}\n              </Accordion>\n            </Col>\n          </Row>\n        </Styles>\n      </div>\n    );\n  }\n}\n\nexport default App;\n"]},"metadata":{},"sourceType":"module"}